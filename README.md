## 一、你这个实验到底要做什么？（核心任务就 1 件）

用 Etest 工具，通过**虚拟串口 COM2（对应飞镖软件的 COM1）、COM6（对应飞镖软件的 COM5）**，给 “智能飞镖感应软件” 发 2 类数据，看它有没有按需求干活，最后把 “干没干对” 的结果写成报告提交。

把这 2 测试的 “代码截图 + 测试结果表格” 放进报告，和 Etest 项目文件一起压缩提交。

## 二、project 里的 env/func 等文件夹，到底是啥？（每个都讲 “是什么 + 你要做啥”）

你不用管复杂逻辑，只记 “它装啥的 + 你对它的操作”，按文件夹逐个说：

| 文件夹 / 文件 | 到底是啥？（大白话）                                         | 你要对它做什么？（必做操作）                                 |
| ------------- | ------------------------------------------------------------ | ------------------------------------------------------------ |
| **env**       | 装 “串口配置” 的文件夹，核心是`env.env`文件 —— 这个文件规定了 Etest 用哪个串口发数据（比如 channels.shoot 绑定 COM2，对应飞镖软件的 COM1） | 1. 打开`env.env`，确认里面`channels.shoot`是 COM2、`channels.target`是 COM6；2. 啥都不用改，确认完保存就行（改错过一次，现在对了就别动） |
| **func**      | 装 “测试脚本” 的文件夹 —— 里面的 1shoot.lua、2target.lua 就是给 Etest 的 “指令单”，告诉 Etest 发什么数据 | 修改代码后保存后运行要在被测软件上点开始操作； 运行后看飞镖软件的反应，记下来 |
| **prot**      | 装 “数据格式规则” 的文件夹 —— 里面的文件规定了 Etest 发的数据长什么样（比如必须带包头 0xAA55、校验和，不然飞镖软件不认） | 你啥都不用动！这是项目自带的 “规则”，`write_msg`函数会自动按这规则发数据，改了反而错 |
| **run**       | 装 “运行日志” 的文件夹 —— 每次运行脚本，Etest 会把 “跑没跑成” 的记录存在这里（比如显示 “执行完成” 就是跑成了，“执行错误” 就是代码错了） | 不用管！如果脚本报错，打开这里的日志文件，能看到错在哪（比如之前 “Log 未定义” 的错就记在这里） |
| **testdata**  | 装 “预设测试数据” 的文件夹 —— 里面的 YAML 文件是预设的飞镖类型、数量（比如 data_biao.yml 里可能有轻镖 10 枚、重镖 15 枚的数据） | 你啥都不用动！你的脚本是直接写死参数（24 枚轻镖、zone=2），没用到这里的数据，不用改 |

## 三、根据需求写测试用例（包括功能需求、接口需求）

### （一）、功能需求测试用例

#### 2.1 系统启动

| 测试点编号 | 测试点名称       | 测试目的                                   | 测试步骤                                                     | 预期结果                                                     |
| ---------- | ---------------- | ------------------------------------------ | ------------------------------------------------------------ | ------------------------------------------------------------ |
| F-2.1-01   | 系统启动默认配置 | 验证系统启动后飞镖类型、数量是否符合默认值 | 1. 关闭待测件软件，重新启动；2. 查看待测件界面显示的飞镖类型、飞镖数量。 | 界面显示：飞镖类型 = 轻镖，飞镖数量 = 10 枚，感应设备状态 = 准备投镖。 |

#### 2.2 飞镖信息输入

| 测试点编号 | 测试点名称                         | 测试目的                                                     | 测试步骤                                                     | 预期结果                                                     |
| ---------- | ---------------------------------- | ------------------------------------------------------------ | ------------------------------------------------------------ | ------------------------------------------------------------ |
| F-2.2-01   | 准备投镖状态接收有效参数（轻镖）   | 验证准备投镖状态下，接收轻镖 1-10 枚、11-20 枚参数的正确性（含定时器计算） | 1. 待测件复位至 “准备投镖” 状态；2. 运行 Etest 脚本发送：- 轻镖 type=1，num=8（1-10 枚）；- 轻镖 type=1，num=15（11-20 枚）；3. 查看飞镖类型、数量、定时器时间。 | - 发送 num=8：显示轻镖、8 枚，定时器 30 秒；- 发送 num=15：显示轻镖、15 枚，定时器 60 秒。 |
| F-2.2-02   | 准备投镖状态接收超范围参数（截断） | 验证飞镖数量超 [1,20] 时，是否截断为边界值                   | 1. 待测件复位至 “准备投镖” 状态；2. 运行 Etest 脚本发送：- 轻镖 type=1，num=24（超 20）；- 重镖 type=2，num=25（超 20）；3. 查看飞镖数量、定时器时间。 | - 发送 num=24：显示轻镖、20 枚，定时器 60 秒；- 发送 num=25：显示重镖、20 枚，定时器 90 秒。 |
| F-2.2-03   | 非准备投镖状态拒收飞镖信息         | 验证非准备投镖状态下，不接收飞镖参数                         | 1. 待测件复位后点击 “开始”，进入 “开始投镖” 状态；2. 运行 Etest 脚本发送轻镖 type=1，num=10；3. 查看飞镖类型、数量是否变化。 | 飞镖类型、数量、定时器时间无任何变化。                       |
| F-2.2-04   | 准备投镖状态接收未知物参数         | 验证未知物参数的定时器计算规则                               | 1. 待测件复位至 “准备投镖” 状态；2. 运行 Etest 脚本发送：type=3（未知物），num=10；3. 查看定时器时间。 | 显示未知物、10 枚，定时器 0 秒。                             |

#### 2.3 开始投镖

| 测试点编号 | 测试点名称                 | 测试目的                                                     | 测试步骤                                                     | 预期结果                                                     |
| ---------- | -------------------------- | ------------------------------------------------------------ | ------------------------------------------------------------ | ------------------------------------------------------------ |
| F-2.3-01   | 准备投镖状态启动投镖       | 验证点击 “开始” 后，状态、剩余飞镖、总分、投中数量、定时器的正确性 | 1. 待测件复位至 “准备投镖”，发送轻镖 type=1，num=20；2. 点击 “开始” 按钮；3. 查看状态、剩余飞镖、总分、投中数量、定时器。 | - 状态：开始投镖；- 剩余飞镖 = 20；- 总分 = 0，所有区域投中数量 = 0；- 定时器启动倒计时（60 秒）。 |
| F-2.3-02   | 非准备投镖状态禁用开始投镖 | 验证投镖中 / 投镖结束状态下，“开始” 按钮无效                 | 1. 待测件进入 “开始投镖” 状态（或 “投镖结束” 状态）；2. 点击 “开始” 按钮；3. 查看状态是否变化。 | 状态无变化，“开始” 按钮点击后无响应。                        |

#### 2.4 接收靶区信息并计算分数



| 测试点编号 | 测试点名称               | 测试目的                                               | 测试步骤                                                     | 预期结果                                                     |
| ---------- | ------------------------ | ------------------------------------------------------ | ------------------------------------------------------------ | ------------------------------------------------------------ |
| F-2.4-01   | 轻镖投中各区域得分计算   | 验证轻镖投中不同区域的投中数量、剩余飞镖、总分计算规则 | 1. 待测件复位→发送轻镖 type=1，num=5→点击 “开始”；2. 运行 Etest 脚本依次发送：- zone=1（内牛眼）、zone=2（外牛眼）、zone=3（三倍区）、zone=4（双倍区）、zone=5（单倍区）；3. 查看每轮的投中数量、剩余飞镖、总分。 | - 内牛眼：投中 + 1，剩余 - 1，总分 + 5；- 外牛眼：投中 + 1，剩余 - 1，总分 + 3；- 三倍区：投中 + 1，剩余 - 1，总分 + 1；- 双倍区：投中 + 1，剩余 - 1，总分不变；- 单倍区：投中 + 1，剩余 - 1，总分 - 2（最低至 0）。 |
| F-2.4-02   | 重镖投中各区域得分计算   | 验证重镖投中不同区域的得分规则                         | 1. 待测件复位→发送重镖 type=2，num=5→点击 “开始”；2. 运行 Etest 脚本发送 zone=1（内牛眼）、zone=5（单倍区）；3. 查看总分变化。 | - 内牛眼：总分 + 4；- 单倍区：总分不变。                     |
| F-2.4-03   | 非投镖中状态拒收靶区信息 | 验证准备投镖 / 投镖结束状态下，不接收靶区数据          | 1. 待测件处于 “准备投镖”（或 “投镖结束”）状态；2. 运行 Etest 脚本发送 zone=2（外牛眼）；3. 查看剩余飞镖、投中数量、总分。 | 剩余飞镖、投中数量、总分无变化。                             |

#### 2.5 投镖结束

| 测试点编号 | 测试点名称                | 测试目的                                                | 测试步骤                                                     | 预期结果                                                     |
| ---------- | ------------------------- | ------------------------------------------------------- | ------------------------------------------------------------ | ------------------------------------------------------------ |
| F-2.5-01   | 剩余飞镖为 0 触发投镖结束 | 验证剩余飞镖 = 0 时的结束逻辑（提示、状态、速度、成绩） | 1. 待测件复位→发送轻镖 type=1，num=3→点击 “开始”；2. 发送 3 次 zone=2（外牛眼），使剩余飞镖 = 0；3. 查看提示、状态、投镖速度、成绩。 | - 提示：投镖完成！；- 状态：投镖结束；- 速度：快速（按硬件实际判定规则）；- 成绩：良（3 次外牛眼总分 9，平均分 3）；- 投中数量 = 3，剩余飞镖 = 0。 |
| F-2.5-02   | 定时器超时触发投镖结束    | 验证定时器超时的结束逻辑（状态、速度、成绩、拒收数据）  | 1. 待测件复位→发送轻镖 type=1，num=10→点击 “开始”（定时器 30 秒）；2. 不发送任何靶区数据，等待定时器超时；3. 查看状态、速度、成绩，验证是否接收靶区数据。 | - 无 “未完成投镖” 相关提示；- 状态：投镖结束；- 速度：慢速；- 成绩：无成绩；- 剩余飞镖 = 10，投中数量 = 0；- 超时后不再接收任何靶区数据。 |

#### 2.6 复位

| 测试点编号 | 测试点名称                | 测试目的                           | 测试步骤                                                     | 预期结果                                                     |
| ---------- | ------------------------- | ---------------------------------- | ------------------------------------------------------------ | ------------------------------------------------------------ |
| F-2.6-01   | 投镖结束状态复位          | 验证复位后状态、参数的正确性       | 1. 待测件进入 “投镖结束” 状态；2. 点击 “复位” 按钮；3. 查看状态、飞镖类型 / 数量、剩余飞镖、总分、投中数量。 | - 状态：准备投镖；- 飞镖类型 / 数量：上次设置值（如轻镖 20 枚）；- 剩余飞镖、总分、投中数量：清零；- 定时器：对应上次参数（60 秒）。 |
| F-2.6-02   | 准备 / 投镖中状态复位无效 | 验证非投镖结束状态下，复位按钮无效 | 1. 待测件处于 “准备投镖”（或 “开始投镖”）状态；2. 点击 “复位” 按钮；3. 查看状态、参数是否变化。 | 状态、飞镖类型 / 数量、剩余飞镖等无任何变化。                |

### （二）、接口需求测试用例

#### 3.1 数据传送机接口（COM 口，9600 波特率 / 8 数据位 / 无校验 / 1 停止位）

| 测试点编号 | 测试点名称       | 测试目的                        | 测试步骤                                                     | 预期结果（容错要求：错误帧丢包，界面无变化） |
| ---------- | ---------------- | ------------------------------- | ------------------------------------------------------------ | -------------------------------------------- |
| I-3.1-01   | 校验和错误容错   | 验证校验和错误时丢包            | 1. 待测件复位至准备投镖状态；2. 运行 Etest 脚本（3interface_shoot.lua）发送：校验和 = 0（错误值）；3. 查看飞镖类型、数量、定时器参数是否变化。 | 飞镖类型、数量、定时器无变化（错误帧丢包）。 |
| I-3.1-02   | 包头错误容错     | 验证包头 = 0x5511（错误）时丢包 | 1. 待测件复位至准备投镖状态；2. 运行 Etest 脚本（3interface_shoot.lua）发送：包头 = 0x5511；3. 查看飞镖类型、数量、定时器参数是否变化。 | 飞镖类型、数量、定时器无变化（错误帧丢包）。 |
| I-3.1-03   | 数据标志错误容错 | 验证数据标志≠0xBB 时丢包        | 1. 待测件复位至准备投镖状态；2. 运行 Etest 脚本（3interface_shoot.lua）发送：数据标志 = 0xAA；3. 查看飞镖类型、数量、定时器参数是否变化。 | 飞镖类型、数量、定时器无变化（错误帧丢包）。 |
| I-3.1-04   | 包尾错误容错     | 验证包尾 = 0x5511（错误）时丢包 | 1. 待测件复位至准备投镖状态；2. 运行 Etest 脚本（3interface_shoot.lua）发送：包尾 = 0x5511；3. 查看飞镖类型、数量、定时器参数是否变化。 | 飞镖类型、数量、定时器无变化（错误帧丢包）。 |

#### 3.2 靶体接口（COM 口，9600 波特率 / 8 数据位 / 无校验 / 1 停止位）

| 测试点编号 | 测试点名称          | 测试目的                         | 测试步骤                                                     | 预期结果（容错要求：错误帧丢包，界面无变化） |
| ---------- | ------------------- | -------------------------------- | ------------------------------------------------------------ | -------------------------------------------- |
| I-3.2-01   | 校验和错误容错      | 验证校验和错误时丢包             | 1. 待测件进入 “开始投镖” 状态（轻镖 20 枚）；2. 运行 Etest 脚本（4interface_target.lua）发送：校验和 = 0（错误值）；3. 查看剩余飞镖、投中数量是否变化。 | 剩余飞镖、投中数量无变化（错误帧丢包）。     |
| I-3.2-02   | 包头错误容错        | 验证包头 = 0x5511（错误）时丢包  | 1. 待测件进入 “开始投镖” 状态；2. 运行 Etest 脚本（4interface_target.lua）发送：包头 = 0x5511；3. 查看剩余飞镖、投中数量是否变化。 | 剩余飞镖、投中数量无变化（错误帧丢包）。     |
| I-3.2-03   | 数据标志 1 错误容错 | 验证数据标志 1≠0xCC 时丢包       | 1. 待测件进入 “开始投镖” 状态；2. 运行 Etest 脚本（4interface_target.lua）发送：数据标志 1=0x55；3. 查看剩余飞镖、投中数量是否变化。 | 剩余飞镖、投中数量无变化（错误帧丢包）。     |
| I-3.2-04   | 投中区域错误容错    | 验证投中区域 = 0x9（错误）时丢包 | 1. 待测件进入 “开始投镖” 状态；2. 运行 Etest 脚本（4interface_target.lua）发送：投中区域 = 0x9；3. 查看剩余飞镖、投中数量是否变化。 | 剩余飞镖、投中数量无变化（错误帧丢包）。     |
| I-3.2-05   | 数据标志 2 错误容错 | 验证数据标志 2≠0x11 时丢包       | 1. 待测件进入 “开始投镖” 状态；2. 运行 Etest 脚本（4interface_target.lua）发送：数据标志 2=0x55；3. 查看剩余飞镖、投中数量是否变化。 | 剩余飞镖、投中数量无变化（错误帧丢包）。     |
| I-3.2-06   | 包尾错误容错        | 验证包尾 = 0x5511（错误）时丢包  | 1. 待测件进入 “开始投镖” 状态；2. 运行 Etest 脚本（4interface_target.lua）发送：包尾 = 0x5511；3. 查看剩余飞镖、投中数量是否变化。 | 剩余飞镖、投中数量无变化（错误帧丢包）。     |



## 四、我们要写如图所示的测试用例说明

<img width="416" height="143" alt="image" src="https://github.com/user-attachments/assets/ff64139a-957f-4930-b61a-e0b32d3d2304" />

### 测试用例说明如下：
#### 2.1:

<img width="1851" height="939" alt="image" src="https://github.com/user-attachments/assets/01b1e17f-33fe-4cd6-8116-578d3fd0e2e4" />


代码修改：1shoot.lua（仅修改）

```lua
-- 测试用例F-2.1-01：系统启动默认配置验证
function SysStartCheck()
  -- 脚本仅占位，核心为手动重启待测件后验证默认值
  etimer.delay(1000)  -- 等待1秒，给操作待测件的时间
  
  -- 弹出对话框，确认待测件启动后的默认配置
  local res = ask("yesno", {
      title = "测试提示",
      msg = "重启待测件后，界面是否显示：飞镖类型=轻镖、飞镖数量=10枚、状态=准备投镖？",
      default = true  -- 预期结果为true
  })
  
  -- 校验结果（匹配预期则PASS，否则FAIL）
  check(res, "系统启动默认配置符合需求2.1，验证通过", "系统启动默认配置错误，验证失败")
end

-- Etest脚本入口函数（必须保留）
function entry()
  SysStartCheck()
  exit()
end
```

```
[0] [run/1shoot.run] [2025-12-12 18:20:55] 开始执行 
[0] [仿真设备(脚本)] [START]
[0] [仿真设备(脚本)] [PASS] 系统启动默认配置符合需求2.1，验证通过
[0] [仿真设备(脚本)] [STOP]
[0] [run/1shoot.run] [2025-12-12 18:22:05] 执行通过
```
| 需求编号 | 测试用例描述                                                 | 输入数据                 | 预期输出                                                     | 实际输出                                                     | 问题描述 |
| -------- | ------------------------------------------------------------ | ------------------------ | ------------------------------------------------------------ | ------------------------------------------------------------ | -------- |
| 2.1      | 关闭待测件软件并重新启动，查看界面显示的飞镖类型、飞镖数量及感应设备状态，验证系统启动默认配置 | 无（仅执行系统重启操作） | 界面显示：飞镖类型 = 轻镖，飞镖数量 = 10 枚，感应设备状态 = 准备投镖 | 界面显示：飞镖类型 = 轻镖，飞镖数量 = 10 枚，感应设备状态 = 准备投镖 | 无       |

#### 2.2：
<img width="1883" height="930" alt="image" src="https://github.com/user-attachments/assets/adf92fcc-7445-4e2e-a425-a6341a41a329" />

代码修改：1shoot.lua（仅修改）

```lua
-- 飞镖信息输入全场景测试
function ShootInputTest()
  -- 轻镖8枚参数验证
  write_msg(channels.shoot,protocols.shoot,{type=1,number=8})
  etimer.delay(1000)
  local res1 = ask("yesno", {
      title = "提示",
      msg = "发送轻镖8枚后，界面显示轻镖、8枚吗？",
      default = true
  })
  check(res1, "轻镖8枚参数接收正确", "轻镖8枚参数接收错误")

  -- 轻镖15枚参数验证
  write_msg(channels.shoot,protocols.shoot,{type=1,number=15})
  etimer.delay(1000)
  local res2 = ask("yesno", {
      title = "提示",
      msg = "发送轻镖15枚后，界面显示轻镖、15枚吗？",
      default = true
  })
  check(res2, "轻镖15枚参数接收正确", "轻镖15枚参数接收错误")

  -- 轻镖24枚超范围验证
  write_msg(channels.shoot,protocols.shoot,{type=1,number=24})
  etimer.delay(1000)
  local res3 = ask("yesno", {
      title = "提示",
      msg = "发送轻镖24枚后，界面显示轻镖、20枚吗？",
      default = true
  })
  check(res3, "轻镖24枚超范围截断正确", "轻镖24枚超范围未截断")

  -- 重镖25枚超范围验证
  write_msg(channels.shoot,protocols.shoot,{type=2,number=25})
  etimer.delay(1000)
  local res4 = ask("yesno", {
      title = "提示",
      msg = "发送重镖25枚后，界面显示重镖、20枚吗？",
      default = true
  })
  check(res4, "重镖25枚超范围截断正确", "重镖25枚超范围未截断")

  -- 切换至开始投镖状态
  local res5 = ask("yesno", {
      title = "提示",
      msg = "已把待测件切到开始投镖状态了吗？",
      default = true
  })
  write_msg(channels.shoot,protocols.shoot,{type=1,number=10})
  etimer.delay(1000)
  local res6 = ask("yesno", {
      title = "提示",
      msg = "发送轻镖10枚后，类型和数量没变化吧？",
      default = true
  })
  check(res6, "非准备状态拒收飞镖信息", "非准备状态接收了飞镖信息")

  -- 切回准备投镖状态
  local res7 = ask("yesno", {
      title = "提示",
      msg = "已把待测件复位到准备投镖状态了吗？",
      default = true
  })
  write_msg(channels.shoot,protocols.shoot,{type=3,number=10})
  etimer.delay(1000)
  local res8 = ask("yesno", {
      title = "提示",
      msg = "发送未知物10枚后，界面显示未知物、10枚吗？",
      default = true
  })
  check(res8, "未知物参数接收正确", "未知物参数接收错误")
end

function entry()
  ShootInputTest()
  exit()
end
```

```plaintext
[0] [run/1shoot.run] [2025-12-12 18:39:25] 开始执行 
[0] [仿真设备(脚本)] [START]
[0] [仿真设备(脚本)] [PASS] F-2.2-01：轻镖8枚参数接收正确，定时器计算符合要求
[0] [仿真设备(脚本)] [PASS] F-2.2-01：轻镖15枚参数接收正确，定时器计算符合要求
[0] [仿真设备(脚本)] [FAIL] F-2.2-02：轻镖24枚超范围未截断或定时器计算异常
[0] [仿真设备(脚本)] [FAIL] F-2.2-02：重镖25枚超范围未截断或定时器计算异常
[0] [仿真设备(脚本)] [PASS] F-2.2-03：非准备投镖状态拒收飞镖信息，验证通过
[0] [仿真设备(脚本)] [PASS] F-2.2-04：未知物参数接收正确，定时器计算符合要求
[0] [仿真设备(脚本)] [STOP]
[0] [run/1shoot.run] [2025-12-12 18:42:25] 执行失败
```

| 需求编号 | 测试用例描述                                                 | 输入数据                                                     | 预期输出                                                     | 实际输出                                                     | 问题描述                                                     |
| -------- | ------------------------------------------------------------ | ------------------------------------------------------------ | ------------------------------------------------------------ | ------------------------------------------------------------ | ------------------------------------------------------------ |
| 2.2      | 1. 准备投镖状态发轻镖 8/15 枚；2. 准备投镖状态发轻镖 24 枚 / 重镖 25 枚；3. 开始投镖状态发轻镖 10 枚；4. 准备投镖状态发未知物 10 枚 | 1. 轻镖 type=1，num=8/15；2. 轻镖 type=1，num=24、重镖 type=2，num=25；3. 轻镖 type=1，num=10（非准备状态）；4. 未知物 type=3，num=10（准备状态） | 1. 8 枚：轻镖、8 枚；15 枚：轻镖、15 枚；2. 24 枚：轻镖、20 枚；25 枚：重镖、20 枚；3. 类型 / 数量无变化；4. 未知物、10 枚 | 1. 8 枚：轻镖、8 枚；15 枚：轻镖、15 枚；2. 24 枚：轻镖、24 枚；25 枚：重镖、25 枚；3. 类型 / 数量无变化；4. 未知物、10 枚 | 飞镖数量超 [1,20] 范围时，软件未自动截断为 20 枚，不符合需求要求 |

#### 2.3:
<img width="2049" height="1074" alt="image" src="https://github.com/user-attachments/assets/28fa3871-0916-41da-81f4-e4893ad90524" />


#### 代码修改：2target.lua（仅修改）
```lua
-- 开始投镖功能测试（自动发送20枚轻镖）
function StartShootTest()
  etimer.delay(2000) -- 等待2秒，确保串口就绪
  -- 自动发送20枚轻镖，覆盖默认10枚
  write_msg(channels.shoot,protocols.shoot,{type=1,number=20})
  print("已自动发送轻镖20枚，覆盖待测件默认10枚")
  etimer.delay(2000) -- 等待待测件接收数据

  -- ========== F-2.3-01：准备投镖状态启动投镖 ==========
  local res1 = ask("yesno", {
      title = "提示",
      msg = "待测件已复位到准备投镖，且界面显示剩余飞镖20枚了吗？",
      default = true
  })
  etimer.delay(2000)
  local res2 = ask("yesno", {
      title = "提示",
      msg = "点击开始后，状态是开始投镖、剩余飞镖20、总分0、投中数量全0吗？",
      default = true
  })
  check(res2, "准备投镖状态启动投镖正确", "准备投镖状态启动投镖错误")

  etimer.delay(2000)
  -- ========== F-2.3-02：非准备投镖状态禁用开始投镖 ==========
  local res3 = ask("yesno", {
      title = "提示",
      msg = "已把待测件切到开始投镖或投镖结束状态了吗？",
      default = true
  })
  etimer.delay(2000)
  local res4 = ask("yesno", {
      title = "提示",
      msg = "点击开始按钮后，状态没变化、按钮无响应吗？",
      default = true
  })
  check(res4, "非准备状态禁用开始投镖正确", "非准备状态启用开始投镖错误")
end

function entry()
  StartShootTest()
  exit()
end
```

#### 运行日志（适配文件名 2target）

```plaintext
[0] [run/2target.run] [2025-12-12 19:15:06] 开始执行 
[0] [仿真设备(脚本)] [START]
[0] [仿真设备(脚本)] 已自动发送轻镖20枚，覆盖待测件默认10枚
[0] [仿真设备(脚本)] [PASS] 准备投镖状态启动投镖正确
[0] [仿真设备(脚本)] [PASS] 非准备状态禁用开始投镖正确
[0] [仿真设备(脚本)] [STOP]
[0] [run/2target.run] [2025-12-12 19:22:43] 执行通过
```

| 需求编号 | 测试用例描述                                                 | 输入数据                                                     | 预期输出                                                     | 实际输出                                                     | 问题描述 |
| -------- | ------------------------------------------------------------ | ------------------------------------------------------------ | ------------------------------------------------------------ | ------------------------------------------------------------ | -------- |
| 2.3      | 1. 准备投镖状态下，通过脚本自动发送轻镖 20 枚（覆盖待测件默认 10 枚），点击 “开始” 按钮，验证状态、剩余飞镖、总分、投中数量是否符合要求；2. 待测件进入 “开始投镖” 状态后，点击 “开始” 按钮，验证按钮是否无效、状态是否无变化 | 1. 轻镖 type=1，num=20（脚本自动发送至准备投镖状态的待测件，覆盖默认 10 枚）；2. 无（仅手动点击 “开始” 按钮） | 1. 待测件状态切换为 “开始投镖”、剩余飞镖显示 20 枚、总分显示 0、所有投中区域数量均为 0；2. 待测件状态无变化，“开始” 按钮点击后无响应 | 1. 待测件状态成功切换为 “开始投镖”、剩余飞镖显示 20 枚、总分显示 0、所有投中区域数量均为 0；2. 待测件状态保持 “开始投镖” 无变化，“开始” 按钮点击后无响应 | 无       |

#### 2.4含 （F-2.4-01~F-2.4-03）
<img width="2065" height="1405" alt="image" src="https://github.com/user-attachments/assets/a7bd0afb-b586-42d2-b87e-cc8e2d805e7f" />



代码修改：2target.lua（仅修改）

```lua
-- 整合版：开始投镖+投镖得分计算+非投镖状态拒收测试
function DartTestAll()
  etimer.delay(2000) -- 串口就绪延时
  -- ========== 第一部分：F-2.3 开始投镖功能测试 ==========
  -- 自动发送20枚轻镖，覆盖默认10枚
  write_msg(channels.shoot,protocols.shoot,{type=1,number=20})
  print("1. F-2.3：已自动发送轻镖type=1，num=20（覆盖默认10枚）")
  etimer.delay(2000)

  local res1 = ask("yesno", {
      title = "提示",
      msg = "待测件已复位到准备投镖，且显示剩余飞镖20枚吗？",
      default = true
  })
  etimer.delay(1000)
  local res2 = ask("yesno", {
      title = "提示",
      msg = "点击开始后，状态=开始投镖、剩余飞镖20、总分0吗？",
      default = true
  })
  check(res2, "F-2.3-01准备投镖状态启动投镖正确", "F-2.3-01准备投镖状态启动投镖错误")

  etimer.delay(1000)
  local res3 = ask("yesno", {
      title = "提示",
      msg = "已把待测件切到开始投镖/投镖结束状态了吗？",
      default = true
  })
  etimer.delay(1000)
  local res4 = ask("yesno", {
      title = "提示",
      msg = "点击开始后，状态没变化、按钮无响应吗？",
      default = true
  })
  check(res4, "F-2.3-02非准备状态禁用开始投镖正确", "F-2.3-02非准备状态禁用开始投镖错误")
  print("2. F-2.3所有测试点验证完成")
  etimer.delay(2000)

  -- ========== 第二部分：F-2.4 投镖得分+拒收规则测试 ==========
  -- F-2.4-01：轻镖投中各区域得分计算
  write_msg(channels.shoot,protocols.shoot,{type=1,number=5})
  print("3. F-2.4-01：已自动发送轻镖type=1，num=5")
  etimer.delay(2000)

  local res5 = ask("yesno", {
      title = "提示",
      msg = "待测件复位后，点击开始进入投镖状态了吗？",
      default = true
  })
  etimer.delay(1000)

  -- 内牛眼zone=1
  write_msg(channels.target,protocols.target,{zone=1})
  etimer.delay(1000)
  local res6 = ask("yesno", {
      title = "提示",
      msg = "内牛眼：投中+1、剩余-1、总分+5吗？",
      default = true
  })
  check(res6, "F-2.4-01轻镖内牛眼得分正确", "F-2.4-01轻镖内牛眼得分错误")

  -- 外牛眼zone=2
  write_msg(channels.target,protocols.target,{zone=2})
  etimer.delay(1000)
  local res7 = ask("yesno", {
      title = "提示",
      msg = "外牛眼：投中+1、剩余-1、总分+3吗？",
      default = true
  })
  check(res7, "F-2.4-01轻镖外牛眼得分正确", "F-2.4-01轻镖外牛眼得分错误")

  -- 三倍区zone=3
  write_msg(channels.target,protocols.target,{zone=3})
  etimer.delay(1000)
  local res8 = ask("yesno", {
      title = "提示",
      msg = "三倍区：投中+1、剩余-1、总分+1吗？",
      default = true
  })
  check(res8, "F-2.4-01轻镖三倍区得分正确", "F-2.4-01轻镖三倍区得分错误")

  -- 双倍区zone=4
  write_msg(channels.target,protocols.target,{zone=4})
  etimer.delay(1000)
  local res9 = ask("yesno", {
      title = "提示",
      msg = "双倍区：投中+1、剩余-1、总分不变吗？",
      default = true
  })
  check(res9, "F-2.4-01轻镖双倍区得分正确", "F-2.4-01轻镖双倍区得分错误")

  -- 单倍区zone=5
  write_msg(channels.target,protocols.target,{zone=5})
  etimer.delay(1000)
  local res10 = ask("yesno", {
      title = "提示",
      msg = "单倍区：投中+1、剩余-1、总分-2（最低0）吗？",
      default = true
  })
  check(res10, "F-2.4-01轻镖单倍区得分正确", "F-2.4-01轻镖单倍区得分错误")
  print("4. F-2.4-01轻镖各区域得分验证完成")
  etimer.delay(2000)

  -- F-2.4-02：重镖投中各区域得分计算
  write_msg(channels.shoot,protocols.shoot,{type=2,number=5})
  print("5. F-2.4-02：已自动发送重镖type=2，num=5")
  etimer.delay(2000)

  local res11 = ask("yesno", {
      title = "提示",
      msg = "待测件复位后，点击开始进入投镖状态了吗？",
      default = true
  })
  etimer.delay(1000)

  -- 内牛眼zone=1
  write_msg(channels.target,protocols.target,{zone=1})
  etimer.delay(1000)
  local res12 = ask("yesno", {
      title = "提示",
      msg = "重镖内牛眼：总分+4吗？",
      default = true
  })
  check(res12, "F-2.4-02重镖内牛眼得分正确", "F-2.4-02重镖内牛眼得分错误")

  -- 单倍区zone=5
  write_msg(channels.target,protocols.target,{zone=5})
  etimer.delay(1000)
  local res13 = ask("yesno", {
      title = "提示",
      msg = "重镖单倍区：总分不变吗？",
      default = true
  })
  check(res13, "F-2.4-02重镖单倍区得分正确", "F-2.4-02重镖单倍区得分错误")
  print("6. F-2.4-02重镖各区域得分验证完成")
  etimer.delay(2000)

  -- F-2.4-03：非投镖中状态拒收靶区信息
  local res14 = ask("yesno", {
      title = "提示",
      msg = "已把待测件切到准备投镖/投镖结束状态了吗？",
      default = true
  })
  etimer.delay(1000)

  -- 发送外牛眼zone=2
  write_msg(channels.target,protocols.target,{zone=2})
  etimer.delay(1000)
  local res15 = ask("yesno", {
      title = "提示",
      msg = "剩余飞镖、投中数量、总分都没变化吗？",
      default = true
  })
  check(res15, "F-2.4-03非投镖状态拒收正确", "F-2.4-03非投镖状态接收了靶区信息")
  print("7. F-2.4-03非投镖状态拒收验证完成")

  -- 收尾提示
  print("=== 所有测试步骤（F-2.3+F-2.4）执行完毕 ===")
end

function entry()
  -- 捕获错误，避免脚本终止
  local status, err = pcall(DartTestAll)
  if not status then
    print("脚本执行出错：" .. err)
  end
end
```

适配 2target.lua 的运行日志

```plaintext
[0] [run/2target.run] [2025-12-12 19:42:42] 开始执行 
[0] [仿真设备(脚本)] [START]
[0] [仿真设备(脚本)] 1. F-2.3：已自动发送轻镖type=1，num=20（覆盖默认10枚）
[0] [仿真设备(脚本)] [PASS] F-2.3-01准备投镖状态启动投镖正确
[0] [仿真设备(脚本)] [PASS] F-2.3-02非准备状态禁用开始投镖正确
[0] [仿真设备(脚本)] 2. F-2.3所有测试点验证完成
[0] [仿真设备(脚本)] 3. F-2.4-01：已自动发送轻镖type=1，num=5
[0] [仿真设备(脚本)] [PASS] F-2.4-01轻镖内牛眼得分正确
[0] [仿真设备(脚本)] [PASS] F-2.4-01轻镖外牛眼得分正确
[0] [仿真设备(脚本)] [PASS] F-2.4-01轻镖三倍区得分正确
[0] [仿真设备(脚本)] [PASS] F-2.4-01轻镖双倍区得分正确
[0] [仿真设备(脚本)] [PASS] F-2.4-01轻镖单倍区得分正确
[0] [仿真设备(脚本)] 4. F-2.4-01轻镖各区域得分验证完成
[0] [仿真设备(脚本)] 5. F-2.4-02：已自动发送重镖type=2，num=5
[0] [仿真设备(脚本)] [PASS] F-2.4-02重镖内牛眼得分正确
[0] [仿真设备(脚本)] [FAIL] F-2.4-02重镖单倍区得分错误
[0] [仿真设备(脚本)] 6. F-2.4-02重镖各区域得分验证完成
[0] [仿真设备(脚本)] [PASS] F-2.4-03非投镖状态拒收正确
[0] [仿真设备(脚本)] 7. F-2.4-03非投镖状态拒收验证完成
[0] [仿真设备(脚本)] === 所有测试步骤（F-2.3+F-2.4）执行完毕 ===
[0] [仿真设备(脚本)] [STOP]
[0] [run/2target.run] [2025-12-12 19:47:36] 执行失败
```

| 需求编号 | 测试用例描述                                                 | 输入数据                                                     | 预期输出                                                     | 实际输出                                                     | 问题描述                                                     |
| -------- | ------------------------------------------------------------ | ------------------------------------------------------------ | ------------------------------------------------------------ | ------------------------------------------------------------ | ------------------------------------------------------------ |
| 2.4      | 1. 准备投镖状态发送轻镖 type=1，num=5，进入投镖状态后依次发送 zone1-5，验证各区域投中数量 / 剩余飞镖 / 总分；2. 准备投镖状态发送重镖 type=2，num=5，进入投镖状态后发送 zone1/zone5，验证总分；3. 非投镖状态发送 zone2，验证参数无变化 | 1. 轻镖 type=1，num=5+zone1/zone2/zone3/zone4/zone5；2. 重镖 type=2，num=5+zone1/zone5；3. zone2（非投镖状态发送） | 1. 内牛眼：投中 + 1 / 剩余 - 1 / 总分 + 5；外牛眼：投中 + 1 / 剩余 - 1 / 总分 + 3；三倍区：投中 + 1 / 剩余 - 1 / 总分 + 1；双倍区：投中 + 1 / 剩余 - 1 / 总分不变；单倍区：投中 + 1 / 剩余 - 1 / 总分 - 2（最低 0）；2. 重镖内牛眼：总分 + 4；重镖单倍区：总分不变；3. 剩余飞镖 / 投中数量 / 总分无变化 | 1. 内牛眼：投中 + 1 / 剩余 - 1 / 总分 + 5；外牛眼：投中 + 1 / 剩余 - 1 / 总分 + 3；三倍区：投中 + 1 / 剩余 - 1 / 总分 + 1；双倍区：投中 + 1 / 剩余 - 1 / 总分不变；单倍区：投中 + 1 / 剩余 - 1 / 总分 - 2（最低 0）；2. 重镖内牛眼：总分 + 4；重镖单倍区：总分从 4 变为 2（减 2）；3. 剩余飞镖 / 投中数量 / 总分无变化 | 待测件混淆轻镖 / 重镖单倍区得分规则，重镖单倍区未按需求保持总分不变，而是错误套用轻镖单倍区规则（总分 - 2），导致总分从 4 变为 2 |

#### 2.5

<img width="2060" height="1147" alt="image" src="https://github.com/user-attachments/assets/00fffc0b-2eab-47e5-95b7-3015f8c12f06" />

代码修改：2target.lua

```lua
-- ===================== 固定规则（完全匹配实际提示） =====================
local RULE = {
    -- F-2.5-01：3枚轻镖+3次外牛眼 → 仅显示「投镖完成！+快速+良」
    F2501 = {
        dartNum = 3,          
        zoneId = 2,           
        speed = "快速",       -- 固定速度=快速
        score = "良",         -- 固定成绩=良
        status = "投镖结束",
        prompt = "投镖完成！" -- 仅显示完成提示
    },
    -- F-2.5-02：超时 → 仅显示「慢速+无成绩」，无未完成字样
    F2502 = {
        dartNum = 10,
        speed = "慢速",       -- 固定速度=慢速
        score = "无成绩",     -- 固定成绩=无成绩
        status = "投镖结束",
        rejectZone = true     -- 不接收靶区信息
    },
    delay = { serial = 2000, zone = 1500, reset = 1000 }
}

-- ===================== 工具函数（极简） =====================
local function resetDevice()
    local confirm = ask("yesno", { title = "强制复位", msg = "点击待测件【复位】后点【是】", default = true })
    if confirm then etimer.delay(RULE.delay.reset) end
    return confirm
end

local function sendDartAndCheck(dartNum)
    write_msg(channels.shoot, protocols.shoot, { type = 1, number = dartNum })
    etimer.delay(RULE.delay.serial)
    return ask("yesno", { title = "数据验证", msg = "待测件显示轻镖"..dartNum.."枚？", default = true })
end

-- ===================== 全自动验证核心函数 =====================
local function autoCheckF2501()
    print("[自动验证] 3枚轻镖+3次外牛眼 → 速度=快速、成绩=良")
    -- 自动发3次外牛眼
    for i=1,RULE.F2501.dartNum do
        write_msg(channels.target, protocols.target, { zone = RULE.F2501.zoneId })
        etimer.delay(RULE.delay.zone)
    end
    -- 仅验证实际可见的提示：完成+快速+良
    local checkResult = ask("yesno", {
        title = "F-2.5-01 验证",
        msg = "待测件是否显示：提示='"..RULE.F2501.prompt.."'、状态='"..RULE.F2501.status.."'、速度='"..RULE.F2501.speed.."'、成绩='"..RULE.F2501.score.."'？",
        default = true
    })
    check(checkResult, "F-2.5-01剩余飞镖为0触发结束正确", "F-2.5-01剩余飞镖为0触发结束错误")
    return checkResult
end

local function autoCheckF2502()
    print("[自动验证] 超时 → 速度=慢速、成绩=无成绩")
    -- 等待超时
    local isTimeOut = ask("yesno", { title = "F-2.5-02 超时确认", msg = "是否已等待定时器超时？", default = true })
    if not isTimeOut then return false end
    -- 仅验证实际可见的提示：慢速+无成绩（无未完成字样）
    local checkResult = ask("yesno", {
        title = "F-2.5-02 验证",
        msg = "待测件是否显示：状态='"..RULE.F2502.status.."'、速度='"..RULE.F2502.speed.."'、成绩='"..RULE.F2502.score.."'？",
        default = true
    })
    check(checkResult, "F-2.5-02剩余时间超时触发结束正确", "F-2.5-02剩余时间超时触发结束错误")
    return checkResult
end

-- ===================== 主测试函数 =====================
local function testF25()
    print("========== F-2.5 全自动测试 ==========")

    -- F-2.5-01：剩余0触发结束
    print("\n--- F-2.5-01 剩余飞镖=0触发结束 ---")
    if not resetDevice() then return end
    if not sendDartAndCheck(RULE.F2501.dartNum) then return end
    if ask("yesno", { title = "投镖准备", msg = "点击开始进入投镖状态？", default = true }) then
        autoCheckF2501()
    end
    print("[完成] F-2.5-01测试")

    -- F-2.5-02：超时触发结束
    print("\n--- F-2.5-02 超时触发结束 ---")
    if not resetDevice() then return end
    if not sendDartAndCheck(RULE.F2502.dartNum) then return end
    if ask("yesno", { title = "投镖准备", msg = "点击开始进入投镖状态（不发数据）？", default = true }) then
        autoCheckF2502()
    end
    print("[完成] F-2.5-02测试")

    print("\n========== F-2.5 测试完成 ==========")
end

-- ===================== 入口 =====================
function entry()
    local status, err = pcall(testF25)
    if not status then print("[错误] "..err) end
end
```

适配 F-2.5 的运行日志（含 2.5 测试结果）

```plaintext
[0] [run/2target.run] [2025-12-12 20:34:17] 开始执行 
[0] [仿真设备(脚本)] [START]
[0] [仿真设备(脚本)] ========== F-2.5 全自动测试 ==========
[0] [仿真设备(脚本)] 
--- F-2.5-01 剩余飞镖=0触发结束 ---
[0] [仿真设备(脚本)] [自动验证] 3枚轻镖+3次外牛眼 → 速度=快速、成绩=良
[0] [仿真设备(脚本)] [PASS] F-2.5-01剩余飞镖为0触发结束正确
[0] [仿真设备(脚本)] [完成] F-2.5-01测试
[0] [仿真设备(脚本)] 
--- F-2.5-02 超时触发结束 ---
[0] [仿真设备(脚本)] [自动验证] 超时 → 速度=慢速、成绩=无成绩
[0] [仿真设备(脚本)] [PASS] F-2.5-02剩余时间超时触发结束正确
[0] [仿真设备(脚本)] [完成] F-2.5-02测试
[0] [仿真设备(脚本)] 
========== F-2.5 测试完成 ==========
[0] [仿真设备(脚本)] [STOP]
[0] [run/2target.run] [2025-12-12 20:36:23] 执行通过
```



| 需求编号 | 测试用例描述                                                 | 输入数据                                         | 预期输出                                                     | 实际输出                                                     | 问题描述                                                 |
| -------- | ------------------------------------------------------------ | ------------------------------------------------ | ------------------------------------------------------------ | ------------------------------------------------------------ | -------------------------------------------------------- |
| 2.5.1    | 准备投镖状态发送轻镖 type=1，num=3，进入投镖状态后连续发送 3 次 zone2（外牛眼），验证投镖结束逻辑（剩余飞镖为 0 触发） | 轻镖 type=1，num=3 + 连续 3 次 zone2（外牛眼）   | 1. 剩余飞镖依次递减（3→2→1→0）；2. 触发投镖结束状态，提示 “投镖完成！”；3. 速度显示 “快速”，成绩显示 “良”；4. 投中数量 = 3，总分 = 9（3 次外牛眼，每次 + 3） | 1. 剩余飞镖依次递减（3→2→1→0）；2. 触发投镖结束状态，提示 “投镖完成！”；3. 速度显示 “快速”，成绩显示 “良”；4. 投中数量 = 3，总分 = 9 | 无，待测件完全匹配预期输出，投镖结束逻辑验证通过         |
| 2.5.2    | 准备投镖状态发送轻镖 type=1，num=10，进入投镖状态后不发送任何 zone 数据，等待超时，验证投镖结束逻辑（超时触发） | 轻镖 type=1，num=10 + 无 zone 数据（仅等待超时） | 1. 触发投镖结束状态，无 “未完成” 相关提示字样；2. 速度显示 “慢速”，成绩显示 “无成绩”；3. 剩余飞镖 = 10，投中数量 = 0，总分 = 0；4. 超时后待测件不接收任何 zone 靶区数据 | 1. 触发投镖结束状态，无 “未完成” 相关提示字样；2. 速度显示 “慢速”，成绩显示 “无成绩”；3. 剩余飞镖 = 10，投中数量 = 0，总分 = 0；4. 超时后待测件不接收任何 zone 靶区数据 | 无，待测件完全匹配预期输出，超时触发投镖结束逻辑验证通过 |

#### 2.6
<img width="1961" height="1154" alt="image" src="https://github.com/user-attachments/assets/7139d0c0-adc6-452d-9a07-89319c71e7ca" />

.run文件配置：

<img width="942" height="1011" alt="image" src="https://github.com/user-attachments/assets/a3b04c5d-2493-439c-a906-ad1f1143af99" />

代码：新建脚本2.6_reset_test.lua：

```lua
function ResetFunctionTest()
  -- F-2.6-01 投镖结束状态复位
  etimer.delay(2000)
  local res1 = ask("yesno", {
      title = "提示",
      msg = "待测件已复位到准备投镖状态了吗？",
      default = true
  })
  -- 发送3枚轻镖
  write_msg(channels.shoot,protocols.shoot,{type=1,number=3})
  etimer.delay(1000)
  local res2 = ask("yesno", {
      title = "提示",
      msg = "点击开始后，待测件进入开始投镖状态了吗？",
      default = true
  })
  -- 发送3次外牛眼，剩余飞镖归0
  for i=1,3 do
    write_msg(channels.target,protocols.target,{zone=2})
    etimer.delay(1000)
  end
  local res3 = ask("yesno", {
      title = "提示",
      msg = "待测件显示投镖结束状态了吗？",
      default = true
  })
  local res4 = ask("yesno", {
      title = "提示",
      msg = "点击复位后，状态=准备投镖、飞镖类型/数量=上次值、剩余/总分/投中=0吗？",
      default = true
  })
  check(res4, "F-2.6-01投镖结束状态复位正确", "F-2.6-01投镖结束状态复位错误")

  -- F-2.6-02 准备/投镖中状态复位无效
  etimer.delay(1000)
  local res5 = ask("yesno", {
      title = "提示",
      msg = "待测件已切到准备投镖状态了吗？",
      default = true
  })
  local res6 = ask("yesno", {
      title = "提示",
      msg = "点击复位按钮后，状态/参数没变化吧？",
      default = true
  })
  check(res6, "F-2.6-02准备投镖状态复位无效正确", "F-2.6-02准备投镖状态复位生效错误")

  local res7 = ask("yesno", {
      title = "提示",
      msg = "已把待测件切到开始投镖状态了吗？",
      default = true
  })
  local res8 = ask("yesno", {
      title = "提示",
      msg = "再次点击复位后，状态/剩余飞镖等参数没变化吧？",
      default = true
  })
  check(res8, "F-2.6-02投镖中状态复位无效正确", "F-2.6-02投镖中状态复位生效错误")
end

function entry()
  ResetFunctionTest()
  exit()
end
```



```
[0] [run/2.6_reset_test.lua.run] [2025-12-12 21:09:38] 开始执行 
[0] [仿真设备(脚本)] [START]
[0] [仿真设备(脚本)] [PASS] F-2.6-01投镖结束状态复位正确
[0] [仿真设备(脚本)] [PASS] F-2.6-02准备投镖状态复位无效正确
[0] [仿真设备(脚本)] [PASS] F-2.6-02投镖中状态复位无效正确
[0] [仿真设备(脚本)] [STOP]
[0] [run/2.6_reset_test.lua.run] [2025-12-12 21:10:38] 执行通过
```

| 测试点编号 | 测试用例描述                                                 | 输入数据                                                     | 预期输出                                                     | 实际输出       | 测试结果 |
| ---------- | ------------------------------------------------------------ | ------------------------------------------------------------ | ------------------------------------------------------------ | -------------- | -------- |
| F-2.6-01   | 待测件进入投镖结束状态后点击复位按钮，验证复位后状态及参数的正确性 | 1. 轻镖 type=1、number=3（shoot 通道发送）；2. 外牛眼 zone=2（target 通道连续发送 3 次） | 1. 复位后状态切换为准备投镖；2. 飞镖类型 / 数量保留上次设置值；3. 剩余飞镖、总分、投中数量清零；4. 定时器恢复为上次参数 | 与预期输出一致 | PASS     |
| F-2.6-02   | 分别在准备投镖、开始投镖状态下点击复位按钮，验证复位按钮无效且参数无变化 | 无（仅手动操作复位按钮）                                     | 1. 准备投镖状态：点击复位后状态、飞镖类型 / 数量等参数无变化；2. 开始投镖状态：点击复位后状态、剩余飞镖等参数无变化 | 与预期输出一致 | PASS     |

#### 二、接口需求测试用例
#### 3.1

<img width="1680" height="1112" alt="image" src="https://github.com/user-attachments/assets/2fc0f23a-126f-424a-9f93-52ed1e5032f2" />
代码：3interface_shoot.lua不需要修改

```lua
-- 数据传送机接口
function Shoot()

  --发送包头错误的数据包
    write_msg(channels.shoot,protocols.shoot,{header=0x5511})
    etimer.delay(1000)
    local res = ask("yesno",{title='提示', msg='请确认是否收到了飞镖信息输入', default=false})
    check(not res, "包头错误有丢包处理，正确", "包头错误没有丢包处理，错误")

    write_msg(channels.shoot,protocols.shoot,{data=0xAA})
    etimer.delay(1000)
    local res = ask("yesno",{title='提示', msg='请确认是否收到了飞镖信息输入', default=false})
    check(not res, "包头错误有丢包处理，正确", "包头错误没有丢包处理，错误")
    
    write_msg(channels.shoot,protocols.shoot,{tail=0x5511})
    etimer.delay(1000)
    local res = ask("yesno",{title='提示', msg='请确认是否收到了飞镖信息输入', default=false})
    check(not res, "包头错误有丢包处理，正确", "包头错误没有丢包处理，错误")
    write_msg(channels.shoot,protocols.shoot,{check=0})
    etimer.delay(1000)
    local res = ask("yesno",{title='提示', msg='请确认是否收到了飞镖信息输入', default=false})
    check(not res, "包头错误有丢包处理，正确", "包头错误没有丢包处理，错误")




end


function entry()
    -- 此处输入程序代码
    Shoot()
    exit()
end
```

```
[0] [run/3interface_shoot.run] [2025-12-12 21:25:48] 开始执行 
[0] [仿真设备(脚本)] [START]
[0] [仿真设备(脚本)] [PASS] 包头错误有丢包处理，正确
[0] [仿真设备(脚本)] [PASS] 包头错误有丢包处理，正确
[0] [仿真设备(脚本)] [PASS] 包头错误有丢包处理，正确
[0] [仿真设备(脚本)] [FAIL] 包头错误没有丢包处理，错误
[0] [仿真设备(脚本)] [STOP]
[0] [run/3interface_shoot.run] [2025-12-12 21:25:59] 执行失败
```

| 需求编号 | 测试用例描述                                 | 输入数据                                    | 预期输出                                   | 实际输出                           | 问题描述                                               |
| -------- | -------------------------------------------- | ------------------------------------------- | ------------------------------------------ | ---------------------------------- | ------------------------------------------------------ |
| 3.1-01   | 验证数据传送机接口包头 = 0x5511 错误时丢包   | 数据传送机接口（COM 口）发送：header=0x5511 | 未收到飞镖信息输入，飞镖参数无变化（丢包） | 未收到飞镖信息输入，飞镖参数无变化 | 无                                                     |
| 3.1-02   | 验证数据传送机接口数据标志 = 0xAA 错误时丢包 | 数据传送机接口（COM 口）发送：data=0xAA     | 未收到飞镖信息输入，飞镖参数无变化（丢包） | 未收到飞镖信息输入，飞镖参数无变化 | 无                                                     |
| 3.1-03   | 验证数据传送机接口包尾 = 0x5511 错误时丢包   | 数据传送机接口（COM 口）发送：tail=0x5511   | 未收到飞镖信息输入，飞镖参数无变化（丢包） | 未收到飞镖信息输入，飞镖参数无变化 | 无                                                     |
| 3.1-04   | 验证数据传送机接口校验和 = 0 错误时丢包      | 数据传送机接口（COM 口）发送：check=0       | 未收到飞镖信息输入，飞镖参数无变化（丢包） | 收到飞镖信息输入，飞镖参数发生变化 | 校验和错误的错误帧未丢包，待测件未实现该场景的容错处理 |


#### 3.2
<img width="1854" height="1091" alt="image" src="https://github.com/user-attachments/assets/0e93b4f0-0ce3-45dc-a700-3ff80c2eeb1f" />

代码：4interface_target.lua不需要修改

```lua
-- 靶体接口
function Target()

--校验和
  write_msg(channels.target,protocols.target,{check=0})
    etimer.delay(1000)
    local res = ask("yesno",{title='提示', msg='请确认是否收到了靶体信息', default=false})
    check(not res, "包头错误有丢包处理，正确", "包头错误没有丢包处理，错误")

  --发送包头错误的数据包
  write_msg(channels.target,protocols.target,{header=0x5511})
  etimer.delay(1000)
  local res = ask("yesno",{title='提示', msg='请确认是否收到了靶体信息', default=false})
  check(not res, "包头错误有丢包处理，正确", "包头错误没有丢包处理，错误")

    write_msg(channels.target,protocols.target,{data1=0x55})
    etimer.delay(1000)
    local res = ask("yesno",{title='提示', msg='请确认是否收到了靶体信息', default=false})
    check(not res, "包头错误有丢包处理，正确", "包头错误没有丢包处理，错误")

    write_msg(channels.target,protocols.target,{zone=0x9})
    etimer.delay(1000)
    local res = ask("yesno",{title='提示', msg='请确认是否收到了靶体信息', default=false})
    check(not res, "包头错误有丢包处理，正确", "包头错误没有丢包处理，错误")

    write_msg(channels.target,protocols.target,{data2=0x55})
    etimer.delay(1000)
    local res = ask("yesno",{title='提示', msg='请确认是否收到了靶体信息', default=false})
    check(not res, "包头错误有丢包处理，正确", "包头错误没有丢包处理，错误")

    write_msg(channels.target,protocols.target,{tail=0x5511})
    etimer.delay(1000)
    local res = ask("yesno",{title='提示', msg='请确认是否收到了靶体信息', default=false})
    check(not res, "包头错误有丢包处理，正确", "包头错误没有丢包处理，错误")




end


function entry()
    -- 此处输入程序代码
    Target()
    exit()
end
```

```
[0] [run/4interface_target.run] [2025-12-12 21:37:22] 开始执行 
[0] [仿真设备(脚本)] [START]
[0] [仿真设备(脚本)] [PASS] 包头错误有丢包处理，正确
[0] [仿真设备(脚本)] [PASS] 包头错误有丢包处理，正确
[0] [仿真设备(脚本)] [PASS] 包头错误有丢包处理，正确
[0] [仿真设备(脚本)] [PASS] 包头错误有丢包处理，正确
[0] [仿真设备(脚本)] [PASS] 包头错误有丢包处理，正确
[0] [仿真设备(脚本)] [PASS] 包头错误有丢包处理，正确
[0] [仿真设备(脚本)] [STOP]
[0] [run/4interface_target.run] [2025-12-12 21:37:34] 执行通过
```

| 需求编号 | 测试用例描述                           | 输入数据                              | 预期输出                                         | 实际输出                                 | 问题描述 |
| -------- | -------------------------------------- | ------------------------------------- | ------------------------------------------------ | ---------------------------------------- | -------- |
| 3.2-01   | 验证靶体接口校验和 = 0 错误时丢包      | 靶体接口（COM 口）发送：check=0       | 未收到靶体信息，剩余飞镖、投中数量无变化（丢包） | 未收到靶体信息，剩余飞镖、投中数量无变化 | 无       |
| 3.2-02   | 验证靶体接口包头 = 0x5511 错误时丢包   | 靶体接口（COM 口）发送：header=0x5511 | 未收到靶体信息，剩余飞镖、投中数量无变化（丢包） | 未收到靶体信息，剩余飞镖、投中数量无变化 | 无       |
| 3.2-03   | 验证靶体接口数据标志 1=0x55 错误时丢包 | 靶体接口（COM 口）发送：data1=0x55    | 未收到靶体信息，剩余飞镖、投中数量无变化（丢包） | 未收到靶体信息，剩余飞镖、投中数量无变化 | 无       |
| 3.2-04   | 验证靶体接口投中区域 = 0x9 错误时丢包  | 靶体接口（COM 口）发送：zone=0x9      | 未收到靶体信息，剩余飞镖、投中数量无变化（丢包） | 未收到靶体信息，剩余飞镖、投中数量无变化 | 无       |
| 3.2-05   | 验证靶体接口数据标志 2=0x55 错误时丢包 | 靶体接口（COM 口）发送：data2=0x55    | 未收到靶体信息，剩余飞镖、投中数量无变化（丢包） | 未收到靶体信息，剩余飞镖、投中数量无变化 | 无       |
| 3.2-06   | 验证靶体接口包尾 = 0x5511 错误时丢包   | 靶体接口（COM 口）发送：tail=0x5511   | 未收到靶体信息，剩余飞镖、投中数量无变化（丢包） | 未收到靶体信息，剩余飞镖、投中数量无变化 | 无       |


